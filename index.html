<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Sprinkles</title>
  <!-- <link rel="stylesheet" href="style.css"> -->

</head>
<body>
  <h1>Sprinkle the world with music</h1>
  <form>
    <input id="nickInput" type="text" placeholder="Your last.fm nick">
    <!-- <input type="range" 1w, 1mo, 3, 6, 12, overall> -->
    <button id="getButton">GET</button>
  </form>

  <div>
  <h2>Resultat</h2>
  <ul id="artists"></ul>
  </div>

  <script>
  var apiUrl = 'http://localhost:8880/api/';
  var artistsHolder = document.getElementById('artists');
  var nickInput = document.getElementById('nickInput');
  var getButton = document.getElementById('getButton');


  var plotIt = function(artists){
    artistsHolder.innerHTML = '';

    artists.forEach(function(artist){
      var li = document.createElement('li');
      li.innerHTML = artist.name + ' - ' + artist.playcount;
      artistsHolder.appendChild(li);
    })
  };

  var fetchData = function(event){
    event.preventDefault();

    fetch(apiUrl + nickInput.value).then(function(a){
      return a.json();
    }).then(function(b){
      console.log(b);
      plotIt(b.artist);
    });
  };

  getButton.addEventListener('click', fetchData);

  </script>
</body>
</html>